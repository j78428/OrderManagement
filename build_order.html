<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>訂單管理系統</title>
    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/jquery-ui.min.css" rel="stylesheet">
    <link href="css/main.css" rel="stylesheet">
    <script src="script/jquery-1.10.2.min.js"></script>
    <script src="script/jquery-ui-1.10.4.custom.min.js"></script>
    <script src="script/bootstrap.min.js"></script>
    <script src="script/main.js"></script>
    <script src="script/common.js"></script>
    <script src="script/pager.js"></script>
    <script src="script/verify.js"></script>
    <script src="script/TSLib.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body>
    <div class="main_content build_order_content">
        <div class="container-fluid">
            <div class="form_title">
                建立訂單
            </div>
            <div class="form_content">
                <div class="block_top">
                    <div class="fill_form">
                        <div class="company_filter">
                            <div class="fill_item">
                                <label class="item_title">指定公司</label>
                                <div class="item_content">
                                    <input type="text" class="form-control input-sm main_order_company search_ubn verify_number action_control" maxlength="8">
                                </div>
                                <div class="tooltip_box tooltip_main_order_company" id="TooltipMainOrderCompany" style="display: none;">
                                    <ul>
                                        <li ubn="54335926" company_name="福泰旅遊有限公司">
                                            <button class="btn btn_style5">
                                                <span class="company_ubn" style="display: none;">54335926</span><span class="company_name">福泰旅遊有限公司</span>
                                            </button>
                                        </li>
                                        <li ubn="54335926" company_name="福泰旅遊有限公司">
                                            <button class="btn btn_style5">
                                                <span class="company_ubn" style="display: none;">9999999999999</span><span class="company_name">福泰旅遊有限公司9</span>
                                            </button>
                                        </li>
                                        <li ubn="54335926" company_name="福泰旅遊有限公司">
                                            <button class="btn btn_style5">
                                                <span class="company_ubn" style="display: none;">3333333333</span><span class="company_name">福泰旅遊有限公司3</span>
                                            </button>
                                        </li>
                                        <li ubn="54335926" company_name="福泰旅遊有限公司">
                                            <button class="btn btn_style5">
                                                <span class="company_ubn" style="display: none;">11111111111</span><span class="company_name">福泰旅遊有限公司1</span>
                                            </button>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="add_main_order" style="display: none;">
                            <div class="fill_item">
                                <label class="item_title">新增主訂單</label>
                                <div class="item_content">
                        <select class="form-control input-sm select_num_type action_control" default="default">
                            <option value="default">預設筆數</option>
                            <option value="custom">自訂筆數</option>
                                    </select>
                                    <select class="form-control  input-sm select_count action_control" default="1">
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                        <option value="6">6</option>
                                        <option value="7">7</option>
                                        <option value="8">8</option>
                                        <option value="9">9</option>
                                        <option value="10">10</option>
                                    </select>
                                    <input class="form-control input-sm input_count verify_number action_control" type="text" style="display: none;">
                                </div>
                                <button class="btn btn_style1 btn_add_main_order action_control">新增訂單</button>
                            </div>
                        </div>
                        <div class="pull-right function_group" style="display: none;">
                            <button class="btn btn_style3 btn_set_notify_time_show" type="button">設定通知時間</button>
                        </div>
                    </div>
                </div>
                <!-- block_top : END -->
                <div class="block_content">
                    <div class="order_list_block">
                    </div>
                </div>
                <!-- block_content : END -->
                <div class="block_bottom" style="display: none;">
                    <div class="function_group">
                        <button class="btn btn-lg btn_disabled btn_un_finish" disabled="disabled">尚有訂單未完成</button>
                        <a href="build_order_confirm.html" type="button" class="btn btn-lg btn_style1 btn_next_step" style="display: none;">下一步:確認訂單資料</a>
                    </div>                 
                </div>
                <div class="function_batch " style="display: none;">
                     <div class="function_group function_notify">
                        <button class="btn btn-lg btn_style1 btn_set_notify_time_ok">設定通知時間</button>
                        <button class="btn btn-lg btn_style3 btn_cancel">取消</button>
                    </div>  
                </div>
            </div>
            <!-- form_content build_order -->
        </div>
        <!-- container-fluid : END -->
    </div>
    <!-- .main_content : END -->
    <div class="build_order_content_modal">
        <div class="modal alert_modal fade in" id="DeleteComfirmAlert" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display:none;z-index:1051">
            <div class="modal-dialog modal-sm">
                <div class="modal-content">
                    <div class="modal-header">
                    </div>
                    <div class="modal-body">
                        <p>確認要刪除?</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn_style2" data-dismiss="modal">取消</button>
                        <button type="button" class="btn btn_style5 btn_delete" data-dismiss="modal">刪除</button>
                    </div>
                </div>
                <!-- .modal-content : END -->
            </div>
        </div>
        <!-- #DeleteComfirm : END -->
        <div class="modal alert_modal fade in" id="ConfirmAlert" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display:none;z-index:1051">
            <div class="modal-dialog modal-sm">
                <div class="modal-content">
                    <div class="modal-header">
                    </div>
                    <div class="modal-body">
                        <p>確定要改變設定?</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn_style2" data-dismiss="modal">取消</button>
                        <button type="button" class="btn btn_style1 btn_ok" data-dismiss="modal">確認</button>
                    </div>
                </div>
                <!-- .modal-content : END -->
            </div>
        </div>
        <!-- #ConfirmAlert : END -->
        <div class="modal alert_modal fade in" id="DateAlert" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display:none;z-index:1051">
            <div class="modal-dialog modal-sm">
                <div class="modal-content">
                    <div class="modal-header">
                    </div>
                    <div class="modal-body">
                        <div class="fill_item">
                            <label class="item_title modal_body_top">設定通知時間</label>
                            <div class="item_content modal_body_bottom">
                                <input type="text" class="form-control input-sm notify_date" placeholder="通知日期">
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn_style2" data-dismiss="modal">取消</button>
                        <button type="button" class="btn btn_style1 btn_ok" data-dismiss="modal">確認</button>
                    </div>
                </div>
                <!-- .modal-content : END -->
            </div>
        </div>
        <!-- #DateAlert : END -->
        <div class="modal alert_modal fade in" id="NoticeAlert" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display:none;z-index:1051">
            <div class="modal-dialog modal-sm">
                <div class="modal-content">
                    <div class="modal-header">
                    </div>
                    <div class="modal-body">
                        <p>未有符合的產品編號</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn_style1 btn_ok" onclick="$('#NoticeAlert').modal('hide')" style="cursor:pointer">確認</button>
                    </div>
                </div>
                <!-- .modal-content : END -->
            </div>
        </div>
    </div>
    <!--  NoticeAlert : END -->
</body>
<script class="order_item_template" type="text/template">
    <div class="order_item">
        <div class="order_item_top">
            <div class="checkbox_block" style="display: none;">
                <input type="checkbox" class="check_item input-sm CheckAll" id="CheckItemAll1" name="CheckItemAll1">
                <label for="CheckItemAll1"><span></span>
                </label>
            </div>
            <div class="item_title">主訂單編號：130600000061</div>
            <div class="item_content">
                <div class="fill_item">
                    <div class="item_content">
                        <select class="form-control input-sm select_type action_control" default="default">
                            <option value="default">預設筆數</option>
                            <option value="custom">自訂筆數</option>
                        </select>
                        <select class="form-control  input-sm select_count action_control" default="1">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                        </select>
                        <input class="form-control input-sm input_count verify_number action_control" type="text" style="display: none;">
                    </div>
                    <button class="btn btn_style1 btn_add_sub_order action_control">新增子訂單</button>
                </div>
            </div>
        </div>
        <div class="sub_order_list list_table">
        </div>
    </div>
</script>
<script class="sub_order_item_template" type="text/template">
    <div class="sub_order_item">
        <div class="sub_order_info">
            <!-- 訂購狀態  status1 : 未選擇 // status2 : 訂購中 // status3 : 完成 // status4 : 失敗 // status5 : 退訂中 // status6 : 退訂完成  -->
            <div class="booking_status status1">
                <div class="status_icon"></div>
                <div class="status title">尚未選擇</div>
            </div>
            <div class="checkbox_block" style="display:none;">
                <div class="checkbox">
                    <input type="checkbox" class="check_item input-sm" id="CheckItem6" name="CheckItem6">
                    <label for="CheckItem6"><span></span>
                    </label>
                </div>
            </div>
            <!-- 還沒選擇產品類型 -->
            <div class="info_content no_choose_content">
                <div class="top_info">子訂單編號：130600000061-1</div>
                <div class="product_select">
                    <select class="form-control  input-sm select_sub_product action_control">
                        <option value="Hotel">飯店</option>  
                        <option value="Ticket">機票</option>  
                        <option value="GroupTour">旅遊行程</option>
                    </select>
                    <a href="#" target="_blank" class="btn btn-sm  btn_style1 btn_choose_product action_control">選擇產品</a>
                    <button class="btn btn-sm btn_style2 btn_cancel_choose_product action_control" style="display:none">取消選擇產品</button>
                </div>
            </div>
            <!-- 已經選擇產品類型 -->
            <div class="info_content product_content" style="display:none;">
                <div class="top_info"><span class="span_sub_order_on">子訂單編號：130600000061-1</span><span class="span_product_type"></span></div>
                <div class="item_title span_product_name"></div>
                <div class="sub_info span_product_detail"></div>
                <div class="price_list">
                    <div class="info_item">
                        <div class="item_title">建議售價：</div>
                        <div class="item_content span_price"></div>
                    </div>
                    <div class="info_item">
                        <div class="item_title">請款通知：</div>
                        <div class="item_content span_notify_date"></div>
                    </div>
                </div>
            </div>
            <div class="pull-right function_group">                
                <button class="btn btn-sm btn_style2 btn_cancel_sub_order action_control" style="display: none;"><span class="glyphicon glyphicon-remove"></span>取消訂單</button>
                <button class="btn btn-sm btn_style1 btn_update action_control" style="display: none;"><span class="glyphicon glyphicon-refresh"></span>更新</button>
                <button class="btn btn-sm btn_style5 btn_delete action_control"><span class="glyphicon glyphicon-remove"></span>移除</button> 
                <div class="product_function_group hotel_function" style="display: none;">
                    <a href="search_hotel.html" target="_blank" class="btn btn-sm btn_style3 btn_research action_control">重選飯店</a>    
                    <a href="search_hotel_room.html" target="_blank" class="btn btn-sm btn_style3 btn_research action_control">重選房型</a>
                    <div class="fill_item">
                        <div class="error_message">此房型確認失敗</div>
                    </div>
                </div>
                <div class="product_function_group air_function" style="display: none;">
                    <a href="search_air.html" target="_blank" class="btn btn-sm btn_style3 btn_research action_control">重選航班</a>
                    <div class="fill_item">
                        <div class="error_message">此航班確認失敗</div>
                    </div>
                </div>
                <div class="product_function_group travel_function" style="display: none;">
                    <a href="search_travel.html" target="_blank" class="btn btn-sm btn_style3 btn_research action_control">重選旅遊行程</a>
                    <div class="fill_item">
                        <div class="error_message">此旅遊行程確認失敗</div>
                    </div>
                </div>
                <div class="fill_item">
                    <div class="error_message" style="display:none;">退訂失敗</div>
                </div>
            </div>
        </div>
        <div class="edit_box">
            <div class="fill_item_group">
                <div class="fill_item">
                    <label class="item_title">建議售價</label>
                    <div class="item_content">
                        <input type="text" class="form-control input-sm verify_number notify_price" placeholder="請輸入金額">
                    </div>
                </div>
                <div class="fill_item">
                    <label class="item_title">請款通知</label>
                    <div class="item_content">
                        <div class="datepicker_input">
                            <input type="text" class="form-control input-sm notify_date" placeholder="未指定日期"><span class="glyphicon glyphicon-calendar"></span>
                        </div>
                        
                    </div>
                </div>
            </div>
            <button class="btn btn_style1 btn_edit_price_date action_control">設定</button>
        </div>
        <div class="sub_order_detail">
            <ul class="nav nav-tabs">
                <li role="presentation" class="active"><a name="OrderInfo" aria-controls="OrderInfo" role="tab" data-toggle="tab" aria-expanded="true">訂購資訊</a></li>
                <li role="presentation"><a name="Passenger" aria-controls="Passenger" role="tab" data-toggle="tab" aria-expanded="false">旅客資料</a></li>
                <li role="presentation"><a name="Contactor" aria-controls="Contactor" role="tab" data-toggle="tab" aria-expanded="false">聯絡人</a></li>
                <li role="presentation"><a name="RemarkInfo" aria-controls="RemarkInfo" role="tab" data-toggle="tab" aria-expanded="false">備註</a></li>
            </ul>
        </div>
        <!-- sub_order_detail : END -->
    </div>
</script>

		<script class="product_hetel_detail_template" type="text/template">
            <div class="tab-content">
                <div class="OrderInfo active tab-pane fade in" style="display: block;">
                    <table>
                        <tr>
                            <td>
                                <div class="info_item">
                                    <div class="info_title">房型資訊</div>
                                    <div class="info_content">雙人床</div>
                                </div>
                            </td>
                            <td>
                                <div class="info_item">
                                    <div class="info_title">入住時間</div>
                                    <div class="info_content">2018/01/08 - 2018/01/12</div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="info_item">
                                    <div class="info_title">早餐</div>
                                    <div class="info_content">不含早餐</div>
                                </div>
                            </td>
                            <td>
                                <div class="info_item">
                                    <div class="info_title">入住成員</div>
                                    <div class="info_content">成人兩位、小孩一位</div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>                                
                                <div class="info_item">
                                    <div class="info_title">房間狀態</div>
                                    <div class="info_content">可立即訂購</div>
                                </div>
                            </td>
                            <td>

                            </td>
                        </tr>
                    </table>   
                </div>
                <div class="Passenger tab-pane fade" style="display: none;">
                    <div class="info_item col-sm-12">
                        <div class="info_passenger_name">王大明（男性）</div>
                        <div class="info_title title_inseparable">旅客備註：</div>
                        <div class="info_content">---</div>
                    </div>
                    <div class="info_item col-sm-12">
                        <div class="info_passenger_name">王曉明（男性）</div>
                        <div class="info_title title_inseparable">旅客備註：</div>
                        <div class="info_content">---</div>
                    </div>
                </div>
                
                <div class="Contactor tab-pane fade" style="display: none;">
                    <table>
                        <tr>
                            <td>
                                <div class="info_item">
                                    <div class="info_title">聯絡人姓名</div>
                                    <div class="info_content">王大明(男性)</div>
                                </div>
                            </td>
                            <td>
                                <div class="info_item">
                                    <div class="info_title">email</div>
                                    <div class="info_content">mi@mail.com</div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>                                
                                <div class="info_item">
                                    <div class="info_title">連絡電話</div>
                                    <div class="info_content">0912345678</div>
                                </div>
                            </td>
                            <td>
                                <div class="info_item">
                                    <div class="info_title">手機電話</div>
                                    <div class="info_content">0912345678</div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="info_item">
                                    <div class="info_title">地址</div>
                                    <div class="info_content">台北市復興北路69號6樓</div>
                                </div>
                            </td>
                            <td>
                                <div class="info_item">
                                    <div class="info_title">收據</div>
                                    <div class="info_content">不須開立收據</div>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div> 
                <div class="RemarkInfo tab-pane fade" style="display: none;">
                    <div class="info_item col-sm-6">
                        <div class="info_title">沒有任何備註</div>
                    </div>
                </div>
            </div>
		</script>

		<script class="product_air_detail_template" type="text/template">    
            <div class="tab-content">
                <div class="OrderInfo active tab-pane fade in" style="display: block;">
                    <div class="air_ticket">
                        <table>
                            <tr>
                                <td>
                                    <div class="info_item">
                                        <div class="info_title">航班資訊</div>
                                        <div class="info_content">台北TPE - 大阪KIX</div>
                                    </div>
                                </td>
                                <td>
                                    <div class="info_item">
                                        <div class="info_title">出發時間</div>
                                        <div class="info_content">2018/01/08 20:15</div>
                                    </div>
                                </td>
                                <td>
                                    <div class="info_item">
                                        <div class="info_title">抵達時間</div>
                                        <div class="info_content">2018/01/09 02:20 </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="info_item">
                                        <div class="info_title">航空公司</div>
                                        <div class="info_content">中華航空</div>
                                    </div>
                                </td>
                                <td>
                                    <div class="info_item">
                                        <div class="info_title">航班</div>
                                        <div class="info_content">TA210</div>
                                    </div>
                                </td>
                                <td>
                                    <div class="info_item">
                                        <div class="info_title">艙等</div>
                                        <div class="info_content">經濟艙</div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>

                                </td>
                                <td>
                                    <div class="info_item"> 
                                        <div class="info_title">轉乘</div>
                                        <div class="info_content">1次：澳門機場(MFM)</div>
                                    </div>
                                </td>
                                <td>
                                    <div class="info_item">
                                        <div class="info_title">行李重量</div>
                                        <div class="info_content">20kg/人</div>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="air_ticket">
                        <table>
                           <tr>
                                <td>
                                    <div class="info_item">
                                        <div class="info_title">
                                            航班資訊
                                        </div>
                                        <div class="info_content">
                                            東京NRT - 台北TPE
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <div class="info_item">
                                        <div class="info_title">
                                            出發時間
                                        </div>
                                        <div class="info_content">
                                            2018/01/10 10:45
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <div class="info_item">
                                        <div class="info_title">
                                            抵達時間
                                        </div>
                                        <div class="info_content">
                                            2018/01/10 13:15
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="info_item">
                                        <div class="info_title">
                                            航空公司
                                        </div>
                                        <div class="info_content">
                                            中華航空
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <div class="info_item">
                                        <div class="info_title">
                                            航班
                                        </div>
                                        <div class="info_content">
                                            TA110
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <div class="info_item">
                                        <div class="info_title">
                                            艙等
                                        </div>
                                        <div class="info_content">
                                            經濟艙
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>

                                </td>
                                <td>
                                    <div class="info_item">
                                        <div class="info_title">
                                            轉乘
                                        </div>
                                        <div class="info_content">
                                            直飛
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <div class="info_item">
                                        <div class="info_title">
                                            行李重量
                                        </div>
                                        <div class="info_content">
                                            20kg/人
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="Passenger tab-pane fade" style="display: none;">
                    <table>
                        <tr>
                            <td>
                                <div class="info_passenger_name">
                                    王大明 / DaMing Wang (男性)
                                </div>
                            </td>
                            <td>
                                <div class="info_item"> 
                                    <div class="info_title title_inseparable">
                                        生日：
                                    </div>
                                    <div class="info_content">
                                        2000/05/05
                                    </div>
                                </div>
                            </td>
                            <td>
                                <div class="info_item"> 
                                    <div class="info_title title_inseparable">
                                        航空公司會員編號：
                                    </div>
                                    <div class="info_content">
                                        ---
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="info_passenger_name">
                                    王曉明 / ShiauMing Wang (男性)
                                </div>
                            </td>
                            <td>
                                <div class="info_item">
                                    <div class="info_title title_inseparable">
                                        生日：
                                    </div>
                                    <div class="info_content">
                                        2000/05/05
                                    </div>
                                </div>
                            </td>
                            <td>
                                <div class="info_item">
                                    <div class="info_title title_inseparable">
                                        航空公司會員編號：
                                    </div>
                                    <div class="info_content">
                                        ---
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
                <div class="Contactor tab-pane fade" style="display: none;">
                    <table>
                        <tr>
                            <td>
                                <div class="info_item">
                                    <div class="info_title">
                                        聯絡人姓名
                                    </div>
                                    <div class="info_content">
                                        王大明(男性)
                                    </div>
                                </div>
                            </td>
                            <td>
                                <div class="info_item">
                                    <div class="info_title">
                                        email
                                    </div>
                                    <div class="info_content">
                                        mi@mail.com
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>                                
                                <div class="info_item">
                                    <div class="info_title">
                                        連絡電話
                                    </div>
                                    <div class="info_content">
                                        0912345678
                                    </div>
                                </div>
                            </td>
                            <td>
                                <div class="info_item">
                                    <div class="info_title">
                                        手機電話
                                    </div>
                                    <div class="info_content">
                                        0912345678
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="info_item">
                                    <div class="info_title">
                                        地址
                                    </div>
                                    <div class="info_content">
                                        台北市復興北路69號6樓
                                    </div>
                                </div>
                            </td>
                            <td>
                                <div class="info_item">
                                    <div class="info_title">
                                        收據
                                    </div>
                                    <div class="info_content">
                                        不須開立收據
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
                <div class="RemarkInfo tab-pane fade" style="display: none;">
                    <div class="info_item col-sm-6">
                        <div class="info_title">
                            沒有任何備註
                        </div>
                    </div>
                </div>
            </div>
		</script>

		<script class="product_travel_detail_template" type="text/template">
            <div class="tab-content">
                <div class="OrderInfo active tab-pane fade in" style="display: block;">
                    <div class="info_item col-sm-12">
                        <div class="info_title">行程類型</div>
                        <div class="info_content">團體旅遊</div>
                    </div>
                    <div class="info_item col-sm-12">
                        <div class="info_title">行程團號</div>
                        <div class="info_content">201709120001/CLA-NTX101405BR7F</div>
                    </div>
                    <div class="info_item col-sm-12">
                        <div class="info_title">出團時間</div>
                        <div class="info_content">2018/02/28</div>
                    </div>
                </div>
                <div class="Passenger tab-pane fade" style="display: none;">
                    <div class="info_item col-sm-12">
                        <div class="info_title">成人：</div>
                        <div class="info_content">
                            <ul class="name_list">
                                <li>
                                    王大明 / DaMing Wang   
                                </li>
                                <li>
                                    王大明 / DaMing Wang
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="info_item col-sm-12">
                        <div class="info_title">小孩：</div>
                        <div class="info_content">
                            <ul class="name_list">
                                <li>
                                    王曉明 / ShiauMing Wang
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="Contactor tab-pane fade" style="display: none;">
                    <table>
                        <tr>
                            <td>
                                <div class="info_item">
                                    <div class="info_title">
                                        聯絡人姓名
                                    </div>
                                    <div class="info_content">
                                        王大明(男性)
                                    </div>
                                </div>
                            </td>
                            <td>
                                <div class="info_item">
                                    <div class="info_title">
                                        email
                                    </div>
                                    <div class="info_content">
                                        mi@mail.com
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>                                
                                <div class="info_item">
                                    <div class="info_title">
                                        連絡電話
                                    </div>
                                    <div class="info_content">
                                        0912345678
                                    </div>
                                </div>
                            </td>
                            <td>
                                <div class="info_item">
                                    <div class="info_title">
                                        手機電話
                                    </div>
                                    <div class="info_content">
                                        0912345678
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="info_item">
                                    <div class="info_title">
                                        地址
                                    </div>
                                    <div class="info_content">
                                        台北市復興北路69號6樓
                                    </div>
                                </div>
                            </td>
                            <td>
                                <div class="info_item">
                                    <div class="info_title">
                                        收據
                                    </div>
                                    <div class="info_content">
                                        不須開立收據
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
                <div class="RemarkInfo tab-pane fade" style="display: none;">
                    <div class="info_item col-sm-6">
                        <div class="info_title">沒有任何備註</div>
                    </div>
                </div>
            </div>
		</script>


<script type="text/javascript">
    var checkBoxAllId = 1; 
    var checkBoxId = 1;
    $(document).ready(function(){
        TSLib.clearInput('body');

        $('.btn_add_main_order').click(function(){
            $(this).closest('.fill_form').find('.function_group').show();
            $(this).closest('.form_content').find('.block_bottom').show();
            var selectType = $('.select_num_type').val();
            var count  = getSelectCount($(this));
            
            for(var i = 1; i<=count;i++) {
                var order_master_id = '13060000006'+i;
                addOrderItem(order_master_id);
            }
        });

        $('.btn_set_notify_time_show').click(function(){
            showBlockFunction(false);
            $('.build_order_content .sub_order_item.active').removeClass('active');
        });

        $('.build_order_content .btn_cancel').click(function(){
            showBlockFunction(true);
        });

        $('.select_num_type').change(function(){
            changeSelectInputType($(this));
        });

        $('.btn_set_notify_time_ok').click(function(){      
            if($('.build_order_content .sub_order_info .check_item').prop('checked')) {
                showDateAlert(function(){
                });
            }else{
                showNotice('請勾選要設定時間項目');
            }
        });

        $('.search_ubn').on("keyup", function() {
            var ubn = $('.build_order_content .search_ubn').val();

            if (ubn != "" && ubn.length ==8 ){
                $('.tooltip_main_order_company').show(); 

                var value = $(this).val().toLowerCase();
                showComapnyList(value);         
            }else{
                $('.tooltip_main_order_company').hide();
            }
        });
    });

    function changeSelectInputType(objSelect){
        switch(objSelect.val()){
            case "default":
                objSelect.parent().find('.select_count').show();  
                objSelect.parent().find('.input_count').hide();
                break;
            case "custom":
                objSelect.parent().find('.select_count').hide();  
                objSelect.parent().find('.input_count').show(); 
                break;
        }
    }
	
	function showBlockFunction(show) {
		if(show) {
            $('.block_top .function_group').show();
            $('.block_bottom').show();
            $('.function_batch').hide();		
            showCheckBox(false);
            disabledBtn(false);
		} else {
            $('.block_top .function_group').hide();
            $('.block_bottom').hide();
            $('.function_batch').show();      
            showCheckBox(true);
            disabledBtn(true);
		}	
	}	

    function showCheckBox(show){
        if(show){            
            $('.check_item').prop('checked',false);
            $('.build_order_content .sub_order_item .checkbox_block').each(function(){
                var objSubOrderItem = $(this).closest('.sub_order_item');
                var status = $(this).closest('.sub_order_item').attr('status');

                if(status == E_Status.booking || status == E_Status.booking_success){
                    objSubOrderItem.find('.checkbox_block').show();
                    objSubOrderItem.find('.booking_status').hide();
                    objSubOrderItem.closest('.order_item').find('.order_item_top .checkbox_block').show();
                }            
                $(this).closest('.sub_order_item').addClass('unavailable');
            }); 
        }else{
            $('.build_order_content .checkbox_block').each(function(){
                $(this).hide();
                var objSubOrderItem = $(this).closest('.sub_order_item');
                objSubOrderItem.find('.booking_status').show();
                $(this).closest('.sub_order_item').removeClass('unavailable');
            })
        }
    }

    function disabledBtn(disabled){        
        if(disabled){
            $('.action_control').prop('disabled', true);
            $('A.action_control').hide();
        }else{
            $('.action_control').prop('disabled', false);
            $('A.action_control').show();            
        }
    }

    function showComapnyList(value){   
        $(".build_order_content .tooltip_main_order_company").find('li').each(function(){
            if($(this).attr('ubn').indexOf(value)>=0) {
                $(this).show();
            } else {
                $(this).hide();
            }

            $(this).click(function(){
                $('.build_order_content .search_ubn').val($(this).attr('company_name'));
                $('.build_order_content .tooltip_main_order_company').hide();
                $('.build_order_content .add_main_order').show();
            });
        });
    }

    function changeBookingStatus(status,source){ 
        var subOrderInfo =  $(source).closest('.sub_order_info');
        var productType = $(source).closest('.sub_order_item').attr('productType');
		subOrderInfo.closest('.sub_order_item').attr('status',status);		
        var objstatus = subOrderInfo.find('.booking_status');        
        $(source).closest('.sub_order_item').removeClass('active');
        
        for(var i=1;i<=6;i++){
            objstatus.removeClass('status'+i);
        }
        
        objstatus.addClass('status'+status); 
        objstatus.closest('.sub_order_item').attr('status',status);

        switch(status) {
            case E_Status.none:
                $(source).closest('.sub_order_item').attr('productType' , 'undefined');
                subOrderInfo.find('.function_group .btn_update').show();
                objstatus.find('.status.title').html('尚未選擇');
                subOrderInfo.find('.function_group .product_function_group').hide();
                subOrderInfo.find('.no_choose_content').show();
                subOrderInfo.find('.product_content').hide();
				break;
            case E_Status.booking:
                subOrderInfo.find('.function_group .btn_update').show();
                objstatus.find('.status.title').html('確認中');
                subOrderInfo.find('.function_group .btn_cancel_sub_order').show();
                subOrderInfo.find('.function_group .product_function_group').hide();
				break;
            case E_Status.booking_success:
                objstatus.find('.status.title').html('確認成功');
                subOrderInfo.find('.function_group .btn_cancel_sub_order').show();
                subOrderInfo.find('.function_group .btn_update').hide();
				break;
            case E_Status.booking_fail: 
                objstatus.find('.status.title').html('確認失敗');
                subOrderInfo.find('.function_group .btn_cancel_sub_order').hide();
                subOrderInfo.find('.function_group .btn_update').hide();
                subOrderInfo.find('.function_group .product_function_group .error_message').show();

                switch(productType){
                    case "Hotel":
                        subOrderInfo.find('.function_group .product_function_group.hotel_function').show();
						break;
                    case "Ticket":
                        subOrderInfo.find('.function_group .product_function_group.air_function').show();
						break;
                    case "GroupTour":
                        subOrderInfo.find('.function_group .product_function_group.travel_function').show();
						break;
                }

				break;
            case E_Status.rejecting:
                objstatus.find('.status.title').html('退訂中');
                subOrderInfo.find('.function_group .btn_cancel_sub_order').hide();
                subOrderInfo.find('.function_group .btn_update').show();
				break;
            case E_Status.reject_success:
                objstatus.find('.status.title').html('退訂完成');
                subOrderInfo.find('.function_group').hide();
				break;
        }        
    }
	
    function showDateAlert(callback) {
        $('#DateAlert').modal('show');
        $('#DateAlert .btn_ok').unbind( "click" );
        $('#DateAlert .btn_ok').bind("click",callback);
    }

    function checkInputBoxNull(txt){
        if(txt == "" || txt == 0){
            showNotice('請輸入數字');
            return false;
        }else{
            var count = $(this).parent().find('.input_count').val();
            return true;
        }
    }

    function addOrderItem(order_master_id) {
        var orderItem = TSLib.addControl('.order_list_block','.order_item_template');
        orderItem.find('.CheckAll').prop('id','CheckItemAll' + checkBoxAllId) ;
        orderItem.find('.CheckAll').prop('name',"CheckItemAll" + checkBoxAllId)  ;
        orderItem.find('.CheckAll').parent().find('label').prop('for',"CheckItemAll" + checkBoxAllId);
        checkBoxAllId++;
        initOrderItem(orderItem);
        return orderItem;
    }

    function checkAll(objCheck){
        if(objCheck.prop('checked')){
            objCheck.closest('.order_item').find('.product_content').each(function(){
                if($(this).css('display') == "block"){
                    $(this).closest('.sub_order_item').removeClass('unavailable');                       
                }
            });
        }else{
            objCheck.closest('.order_item').find('.product_content').each(function(){
                if($(this).css('display') == "block"){
                    $(this).closest('.sub_order_item').addClass('unavailable');                       
                }
            });                
        }    
    }

    function getSelectCount(objSelector){     
        selectType = objSelector.parent().find('.select_type').val();

        if(selectType == undefined){selectType  = objSelector.parent().find('.select_num_type').val(); }

        switch(selectType){
            case "default":
                return objSelector.parent().find('.select_count').val();
                break;
            case "custom":
                return objSelector.parent().find('.input_count').val();                       
        }
    }

    function initOrderItem(objOrderItem) {
        objOrderItem.find('.CheckAll').click(function(){ 
            $(this).closest('.order_item').find('.check_item').prop('checked', $(this).prop('checked'));
            checkAll($(this));                    
        });

        objOrderItem.find('.select_type').change(function(){
            changeSelectInputType($(this));
        });

        objOrderItem.find('.btn_add_sub_order').click(function(){
            var count  = getSelectCount($(this));

            for(var i = 1; i<=count;i++) {
                var order_master_id = '13060000006'+i;
                addSubOrderItem(objOrderItem);
            }
        });
    }

    function addSubOrderItem(objOrderItem) {
        var objSubOrderList = objOrderItem.find('.sub_order_list');  
        var objSubOrderItem = TSLib.addControl(objSubOrderList,'.sub_order_item_template');  
        objSubOrderItem.find('.check_item').prop('id','CheckItem'+checkBoxId)  ;
        objSubOrderItem.find('.check_item').prop('name','CheckItem'+checkBoxId) ;        
        objSubOrderItem.find('.check_item').parent().find('label').prop('for','CheckItem' + checkBoxId);
        checkBoxId++;
        initSubOrderItem(objSubOrderItem)
    }

    function initSubOrderItem(objSubOrderItem) {
        objSubOrderItem.attr('status',E_Status.none);
        objSubOrderItem.attr('productType','undefined');

        objSubOrderItem.find('.verify_number').keypress(function(event){
            return /[0-9\.]/.test(String.fromCharCode(event.which || event.keyCode));
        });

        objSubOrderItem.find('.btn_delete').click(function(){
            objSubOrderItem.remove();
        });

        objSubOrderItem.find('.btn_update').click(function(){ 
			var status = objSubOrderItem.attr('status');
            var objSubOrderInfo = $(this).closest('.sub_order_info');

			switch(status) {
			case E_Status.none.toString():
                objSubOrderInfo.find('.no_choose_content').hide();
                changeBookingStatus(E_Status.booking,this);
                objSubOrderInfo.find('.btn_cancel_sub_order').show();                
                objSubOrderInfo.find('.product_content').show();        
                $('.btn_un_finish').hide();
                $('.btn_next_step').show();

                objSubOrderItem.attr('productType' ,objSubOrderItem.find('.select_sub_product').val()) ;
                var productDetail = new Object();
                productDetail['Hotel'] = '.product_hetel_detail_template';
                productDetail['Ticket'] = '.product_air_detail_template';
                productDetail['GroupTour'] = '.product_travel_detail_template';
                objSubOrderItem.find('.sub_order_detail .tab-content').remove();
                TSLib.addControl(objSubOrderItem.find('.sub_order_detail'),productDetail[objSubOrderItem.attr('productType')]);
                inputProductData(objSubOrderItem);
                break;
            case E_Status.booking.toString():
                changeBookingStatus(E_Status.booking_success,this);
                break;
            case E_Status.rejecting.toString():
                changeBookingStatus(E_Status.reject_success,this);
                objSubOrderInfo.find('.function_group').hide();
                break;
			}

            if(objSubOrderItem.hasClass('active')){
                objSubOrderItem.removeClass('active');
            }
        });

        objSubOrderItem.find('.btn_research').click(function(){
            changeBookingStatus(E_Status.none,this);
        });

        objSubOrderItem.find('.btn_cancel_choose_product').click(function(){
            objSubOrderItem.find('.btn_choose_product').show();   
            objSubOrderItem.find('.select_sub_product').show();
            $(this).hide();
            objSubOrderItem.find('.btn_delete').show();
            objSubOrderItem.find('.btn_update').hide();
        });
        
        objSubOrderItem.find('.btn_choose_product').click(function(e){
            var productType = objSubOrderItem.find('.select_sub_product').val();
            var urlMap = new Object();
            urlMap['Hotel'] = 'search_hotel.html';
            urlMap['Ticket'] = 'search_air.html';
            urlMap['GroupTour'] = 'search_travel.html';
            var url = urlMap[productType];            
            $(this).prop('href',url);

            objSubOrderItem.find('.btn_choose_product').hide();   
            objSubOrderItem.find('.select_sub_product').hide();
            objSubOrderItem.find('.btn_cancel_choose_product').show();
            objSubOrderItem.find('.btn_delete').hide();
            objSubOrderItem.find('.btn_update').show();
        });

        objSubOrderItem.find('.sub_order_info').click(function(e){ 
            var status = objSubOrderItem.attr('status');
            if($(e.target)[0].nodeName != 'BUTTON' && (status == E_Status.booking.toString() || status == E_Status.booking_success.toString() )  && $(this).find('button').attr('disabled') != 'disabled' ){
                if ($(this).parent().hasClass('active')){         
                    $(this).parent().removeClass('active');
                }else{  
                    $('.build_order_content .sub_order_item.active').removeClass('active');
                    $(this).parent().addClass('active'); 
                }     
            }   
        }); 

        objSubOrderItem.find('.sub_order_detail .nav-tabs li a').click(function(){
            var control = $(this).prop('name');
            $(this).closest('.sub_order_detail').find('.tab-content').find('.active').removeClass('in').removeClass('active').hide();
            $(this).closest('.sub_order_detail').find('.tab-content').find('.'+control).addClass('in').addClass('active').show();
        });

        objSubOrderItem.find('.check_item').click(function(){
            if(objSubOrderItem.hasClass('unavailable')){
                objSubOrderItem.removeClass('unavailable');
            }else{
                objSubOrderItem.addClass('unavailable');
            }

            var AllChecked = true;
            objSubOrderItem.closest('.sub_order_list').find('.check_item').each(function(){
                if($(this).prop('checked') == false){
                    AllChecked = false;
                }
            });
            objSubOrderItem.closest('.order_item').find('.CheckAll').prop('checked',AllChecked);
        });

        objSubOrderItem.find('.btn_cancel_sub_order').click(function(){
            showComfirmAlert('確定要取消訂單?',() => {
                changeBookingStatus(E_Status.rejecting,$(this));
            });
        });
        
        initNotifyDate();
        
        objSubOrderItem.find('.btn_edit_price_date').click(function(){
            var price = objSubOrderItem.find('.edit_box .notify_price').val();
            var notify_date = objSubOrderItem.find('.edit_box .notify_date').val();
            notify_date = notify_date.replace('-',"/").replace('-',"/");
            if(price != "" && notify_date != ""){
                showComfirmAlert('確定要改變設定?',function(){
                    objSubOrderItem.find('.span_price').html(TSLib.numberFormat(price));
                    objSubOrderItem.find('.span_notify_date').html(notify_date);
                });
            }else{
                showNotice('請輸入金額與時間');
            }
        });        
    }

    function inputProductData(objSubOrderItem){     
        objSubOrderItem.find('.span_sub_order_on').html('子訂單編號：130600000061-1');
        var productType = objSubOrderItem.attr('productType');

        switch(productType){
        case "Hotel":
            objSubOrderItem.find('.span_product_type').html('類型：飯店');
            objSubOrderItem.find('.span_product_name').html("簡單生活會館");
            objSubOrderItem.find('.span_product_detail').html("雙人房*1");
            break;
        case "Ticket":
            objSubOrderItem.find('.span_product_type').html("類型：機票");
            objSubOrderItem.find('.span_product_name').html("中華航空 台北TPE 到 大阪KIX / 東京NRT 到 台北TPE  ");
            objSubOrderItem.find('.span_product_detail').html("經濟艙，2位成人");
            break;
        case "GroupTour":
            objSubOrderItem.find('.span_product_type').html("類型：旅遊行程");
            objSubOrderItem.find('.span_product_name').html("關西秘境～神鍋高原戲雪、美山合掌村、舟遊伊根灣、姬路雙溫泉五日(含稅)");
            objSubOrderItem.find('.span_product_detail').html("2018/02/28出團");  
            break;
        }

		var today = new Date();
	    var today = today.getFullYear() + '/' + (today.getMonth()+1) + '/' + today.getDate();
		
        objSubOrderItem.find('.span_price').html("$3,000");
        objSubOrderItem.find('.span_notify_date').html(today);
    }
</script>

</html>